module sub_nb
!! Fortran module for main_nb.f90 which solves the dynamic response of 
!! a metabeam of bistable elements using Newmark-beta method.
!!
!! Author: Written by Myungwon Hwang (hwang125@purdue.edu)

implicit none
private
public :: calc_fs_metabeam, calc_kThat_metabeam, calc_fs_pendula, calc_kThat_pendula
public :: calc_fs_phi4, calc_kThat_phi4, NR_iterations, calc_load
public :: DoF, s_dim, p_calc_fs, p_calc_kThat

integer :: DoF ! unit cell degrees of freedom
integer :: s_dim
procedure (calc_fs_metabeam), pointer :: p_calc_fs => NULL()
procedure (calc_kThat_metabeam), pointer :: p_calc_kThat => NULL()

contains
    subroutine calc_fs_metabeam(BC_flag, lowerBound, upperBound, u, s, fs)

    ! Data dictionary:
    integer, intent(in) :: BC_flag ! Boundary condition
    integer, intent(in) :: lowerBound !
    integer, intent(in) :: upperBound !
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s !
    real, intent(out), dimension(DoF) :: fs !

    ! Calculation for fs
    if (BC_flag == 100) then ! baseline, periodic
        fs(1) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(2) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(3) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        fs(4) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        fs(5) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        fs(6) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

    else if (BC_flag == 110) then ! baselie, left end free
        fs(1) = (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(2) = (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(3) = (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        fs(4) = (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        fs(5) = (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)
        
        fs(6) = (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

    else if (BC_flag == 111 .or. BC_flag == 211) then ! Left end fixed
        fs(1) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(2) = (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(3) = 0.

        fs(4) = 0.

        fs(5) = 0.

        fs(6) = 0.

    else if (BC_flag == 120) then ! baseline, right end free
        fs(1) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        fs(2) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        fs(3) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        fs(4) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        fs(5) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        fs(6) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5)))/Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*(s(10) + s(11) + u(3) - u(5)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

    else if (BC_flag == 121 .or. BC_flag == 221) then ! baseline, right end fixed
        fs(1) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)

        fs(2) = (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)

        fs(3) = 0.
        
        fs(4) = 0.

        fs(5) = 0.
        
        fs(6) = 0.

    else if (BC_flag == 200) then ! bottom fixed, periodic
        fs(1) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(2) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(3) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(8)*(s(9) - u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*u(2)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        fs(4) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(8)*(s(10) + s(11) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(10) + s(11) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        fs(5) = 0.

        fs(6) = 0.

    else if (BC_flag == 210) then ! bottom fixed, left end free
        fs(1) = (s(3)*(s(12) - u(0))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        fs(2) = (s(3)*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)
        
        fs(3) = -((s(8)*(s(9) - u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &    Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)) + &
        & (s(6)*u(2)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        fs(4) = (s(8)*(s(10) + s(11) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        fs(5) = 0.

        fs(6) = 0.

    else if (BC_flag == 220) then ! bottom fixed, right end free
        fs(1) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        fs(2) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        fs(3) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(6)*u(2)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        fs(4) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(10) + s(11) + u(3))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        fs(5) = 0.

        fs(6) = 0.

    END IF

    end subroutine calc_fs_metabeam



    !=============================================================================
    !=============================================================================
    subroutine calc_kThat_metabeam(BC_flag, lowerBound, upperBound, u, s, a, kThat)

    ! Data dictionary:
    integer, intent(in) :: BC_flag ! Boundary condition
    integer, intent(in) :: lowerBound !
    integer, intent(in) :: upperBound !
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s !
    real, intent(in), dimension(DoF) :: a !
    real, intent(out), dimension(3*DoF*DoF) :: kThat !
    integer :: it

    kThat = 0.
    if (BC_flag == 100) then ! baseline, periodic
        kThat(1)= (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(2) =  -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(7) = -((s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(8) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(11) = -((s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(12) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(13) = (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(14) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(19) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(20) = -((s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(25) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(26) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(29) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(30) = -((s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(31) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(32) = -((s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &    Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(39) = (s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(40) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)
        
        kThat(41) = -((s(7)*(s(9) - u(-2) + u(2))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)

        kThat(42) = -((s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &    ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = -((s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(8)*(s(9) - u(2) + u(10))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 + &
        & (s(8)*(s(9) - u(2) + u(10))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(46) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(47) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(48) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(51) = (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(52) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(53) = (s(8)*(s(9) - u(2) + u(10))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(54) = -((s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &    ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5) + &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(57) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(58) = -((s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 + &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(59) = -((s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &    ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5

        kThat(60) = -((s(7)*(s(10) + s(11) - u(-1) + u(3))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(64) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11))**2)/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 + &
        & (s(8)*(s(10) + s(11) + u(3) - u(11))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(65) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(66) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(69) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(70) = -((s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &    Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(71) = -((s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &    ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5) + &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(72) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &    Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11))**2)/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(10) + s(11) + u(3) - u(11))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(75) = (s(8)*(s(9) - u(-4) + u(4))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(76) = -((s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(77) = (s(5)*(s(9) - u(-2) + u(4))**2*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))**2)/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(78) = -((s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5)))/&
        &    ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(u(-1) - u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(79) = (s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(80) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(81) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(82) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(83) = -((s(8)*(s(9) - u(-4) + u(4))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(5)*(s(9) - u(-2) + u(4))**2*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(s(9) - u(-2) + u(4))**2)/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(5)*(s(9) - u(4) + u(10))**2*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(84) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))*(u(-1) - u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(87) = -((s(7)*(s(9) - u(4) + u(8))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)

        kThat(88) = -((s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &    ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5

        kThat(89) = (s(5)*(s(9) - u(4) + u(10))**2*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(90) = -((s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &    ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5) + &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(93) = -((s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(94) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5))**2)/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(10) + s(11) + u(-3) - u(5))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(95) = (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(96) = -((s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &    Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(u(-1) - u(5))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(97) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(98) = (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(99) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(100) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(101) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(102) = (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5))**2)/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 + &
        & (s(8)*(s(10) + s(11) + u(-3) - u(5))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(u(-1) - u(5))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11))**2)/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 + &
        & (s(5)*(u(5) - u(11))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(105) = -((s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &    ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5

        kThat(106) = -((s(7)*(s(10) + s(11) - u(5) + u(9))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)

        kThat(107) = -((s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + & 
        & (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &    ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5) + &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(108) = -((s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &    Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11))**2)/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(u(5) - u(11))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

    else if (BC_flag == 110) then ! baseline, left end free
        kThat(7) = (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(8) = (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(11) = -((s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(12) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(13) = (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(14) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(25) = (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(26) = (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(29) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(30) = -((s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(31) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(32) = -((s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &    Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(8)*(s(9) - u(2) + u(10))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 + &
        & (s(8)*(s(9) - u(2) + u(10))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(46) = (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(47) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(48) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(51) = (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(52) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(53) = (s(8)*(s(9) - u(2) + u(10))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(54) = -((s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &    ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5) + &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(64) = (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &  Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11))**2)/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 + &
        & (s(8)*(s(10) + s(11) + u(3) - u(11))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(65) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(66) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(69) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(70) = -((s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &    Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(71) = -((s(8)*(s(9) - u(2) + u(10))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11)))/&
        &    ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5) + &
        & (s(8)*(s(9) - u(2) + u(10))*(s(10) + s(11) + u(3) - u(11)))/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(72) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)))/&
        &    Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2))*(s(10) + s(11) + u(3) - u(11))**2)/&
        &  ((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)**1.5 - &
        & (s(8)*(s(10) + s(11) + u(3) - u(11))**2)/((s(9) - u(2) + u(10))**2 + (s(10) + s(11) + u(3) - u(11))**2)

        kThat(79) = (s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(80) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(81) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(82) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(83) =  -((s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(5)*(s(9) - u(4) + u(10))**2*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(84) = (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(87) = -((s(7)*(s(9) - u(4) + u(8))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)

        kThat(88) = -((s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &    ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5

        kThat(89) = (s(5)*(s(9) - u(4) + u(10))**2*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(90) = -((s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &    ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5) + &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(97) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(98) = (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(99) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(100) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(101) = -((s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(102) = -((s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) - &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &  Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11))**2)/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 + &
        & (s(5)*(u(5) - u(11))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(105) = -((s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9)))/&
        &    ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(9) - u(4) + u(8))*(s(10) + s(11) - u(5) + u(9))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5

        kThat(106) = -((s(7)*(s(10) + s(11) - u(5) + u(9))**2)/((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)) + &
        & (s(7)*(s(10) + s(11) - u(5) + u(9))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  ((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)))/&
        &  Sqrt((s(9) - u(4) + u(8))**2 + (s(10) + s(11) - u(5) + u(9))**2)

        kThat(107) = -((s(5)*(s(9) - u(4) + u(10))*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11)))/&
        &    ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5) + &
        & (s(5)*(s(9) - u(4) + u(10))*(u(5) - u(11)))/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

        kThat(108) = -((s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)))/&
        &    Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2))*(u(5) - u(11))**2)/&
        &  ((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)**1.5 - &
        & (s(5)*(u(5) - u(11))**2)/((s(9) - u(4) + u(10))**2 + (u(5) - u(11))**2)

    else if (BC_flag == 111 .or. BC_flag == 211) then ! baseline, left end fixed
        kThat(7) = (s(2)*(s(12) - u(0))**2*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(8) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))*(s(10) - u(1)))/((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(13) = (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(14) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(25) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))*(s(10) - u(1)))/((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(26) = -((s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &    Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)) + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1))**2)/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(10) - u(1))**2)/((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(11) + u(1))**2*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(31) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(32) = -((s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &    Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

    else if (BC_flag == 120) then ! baseline, right end free
        kThat(1) = (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(2) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(7) = -((s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(8) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(11) = -((s(3)*(s(12) - u(0) + u(4))**2*(Sqrt(s(11)**2 + s(12)**2) - &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(12) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(19) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(20) = -((s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(25) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(26) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(29) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(30) = -((s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &    Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(39) = (s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(40) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(41) = -((s(7)*(s(9) - u(-2) + u(2))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)

        kThat(42) = -((s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &    ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = -((s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(46) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(47) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(48) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(57) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(58) = -((s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 + &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(59) = -((s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &    ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5

        kThat(60) = -((s(7)*(s(10) + s(11) - u(-1) + u(3))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(9) - u(-2) + u(2))*(s(10) + s(11) - u(-1) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(64) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2)/((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(7)*(s(10) + s(11) - u(-1) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  ((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(2))**2 + (s(10) + s(11) - u(-1) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(65) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(66) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(75) = (s(8)*(s(9) - u(-4) + u(4))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(76) = -((s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(77) = (s(5)*(s(9) - u(-2) + u(4))**2*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))**2)/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(78) = -((s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5)))/&
        &    ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(u(-1) - u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(79) = (s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(80) = -((s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &        Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &    ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5) + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(81) = (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(82) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(83) = -((s(8)*(s(9) - u(-4) + u(4))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(5)*(s(9) - u(-2) + u(4))**2*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(s(9) - u(-2) + u(4))**2)/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(3)*(s(12) - u(0) + u(4))**2*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))**2*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  ((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(84) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))*(u(-1) - u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) + &
        & (s(3)*(s(12) - u(0) + u(4))*(-Sqrt(s(11)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(93) = -((s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &    ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5) + &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(94) = -((s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &        Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)) + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5))**2)/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(10) + s(11) + u(-3) - u(5))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)

        kThat(95) = (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(s(9) - u(-2) + u(4))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(96) = -((s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &    Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)) - &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(u(-1) - u(5))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(97) = (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(98) = (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)

        kThat(99) = (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(100) = -((s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &    Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 - &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)

        kThat(101) = (s(8)*(s(9) - u(-4) + u(4))*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 - &
        & (s(8)*(s(9) - u(-4) + u(4))*(s(10) + s(11) + u(-3) - u(5)))/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) - &
        & (s(3)*(s(12) - u(0) + u(4))*(Sqrt(s(11)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*(s(11) + u(1) - u(5)))/&
        &  ((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 - &
        & (s(3)*(s(12) - u(0) + u(4))*(s(11) + u(1) - u(5)))/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(u(2) - u(4))*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(u(2) - u(4))*(s(10) + s(11) + u(3) - u(5)))/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(5)*(s(9) - u(-2) + u(4))*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 + &
        & (s(5)*(s(9) - u(-2) + u(4))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

        kThat(102) = (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)))/&
        &  Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2) - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)))/&
        &  Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) + &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)))/&
        &  Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) - &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2))*(s(10) + s(11) + u(-3) - u(5))**2)/&
        &  ((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2)**1.5 + &
        & (s(8)*(s(10) + s(11) + u(-3) - u(5))**2)/((s(9) - u(-4) + u(4))**2 + (s(10) + s(11) + u(-3) - u(5))**2) + &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2))*&
        &    (s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2)**1.5 + &
        & (s(3)*(s(11) + u(1) - u(5))**2)/((s(12) - u(0) + u(4))**2 + (s(11) + u(1) - u(5))**2) - &
        & (s(6)*(-s(10) - s(11) + Sqrt((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2))*&
        &    (s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2)**1.5 + &
        & (s(6)*(s(10) + s(11) + u(3) - u(5))**2)/((u(2) - u(4))**2 + (s(10) + s(11) + u(3) - u(5))**2) + &
        & (s(5)*(-s(9) + Sqrt((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2))*(u(-1) - u(5))*(-u(-1) + u(5)))/&
        &  ((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)**1.5 - &
        & (s(5)*(u(-1) - u(5))*(-u(-1) + u(5)))/((s(9) - u(-2) + u(4))**2 + (u(-1) - u(5))**2)

    else if (BC_flag == 121 .or. BC_flag == 221) then ! baseline, right end fixed
        kThat(1) = (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(2) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(7) = (s(2)*(s(12) - u(0))**2*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)

        kThat(8) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))*(s(10) - u(1)))/((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5

        kThat(19) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(20) = -((s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(25) = (s(2)*(s(12) - u(0))*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1)))/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0))*(s(10) - u(1)))/((s(12) - u(0))**2 + (s(10) - u(1))**2) - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5

        kThat(26) = -((s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)))/&
        &    Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(10) - u(1))**2))*(s(10) - u(1))**2)/&
        &  ((s(12) - u(0))**2 + (s(10) - u(1))**2)**1.5 + &
        & (s(2)*(s(10) - u(1))**2)/((s(12) - u(0))**2 + (s(10) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(11) + u(1))**2*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)

    else if (BC_flag == 200) then ! bottom fixed, periodic
        kThat(1) = (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(2) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(7) = -((s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(8) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(13) = (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(14) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(19) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(20) = -((s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(25) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(26) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(11) + u(1))**2*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(31) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(32) = -((s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &    Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(39) = (s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(40) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = -((s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(8)*(s(9) - u(2))**2)/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*u(2)**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))**2)/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(8)*(s(9) - u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(6)*u(2)**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(7)*(s(9) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(46) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(51) = (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(52) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(57) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(58) = -((s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 + &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(64) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(8)*(s(10) + s(11) + u(3))**2)/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(10) + s(11) + u(3))**2)/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(8)*(s(10) + s(11) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(6)*(s(10) + s(11) + u(3))**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(7)*(s(10) + s(11) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(69) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(70) = -((s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &    Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

    else if (BC_flag == 210) then ! bottom fixed, left end free
        kThat(7) = (s(3)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(8) = -((s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2)) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(13) = (s(1)*(s(9) - u(0) + u(6))**2*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(14) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(25) = -((s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2)) + &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(26) = (s(3)*(s(11) + u(1))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(11) + u(1))**2*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &  Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 + &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(31) = -((s(1)*(s(9) - u(0) + u(6))*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7)))/&
        &    ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5) + &
        & (s(1)*(s(9) - u(0) + u(6))*(u(1) - u(7)))/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(32) = -((s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)))/&
        &    Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2))*(u(1) - u(7))**2)/&
        &  ((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)**1.5 - &
        & (s(1)*(u(1) - u(7))**2)/((s(9) - u(0) + u(6))**2 + (u(1) - u(7))**2)

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = (s(8)*(s(9) - u(2))**2)/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*u(2)**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(8)*(s(9) - u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(6)*u(2)**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(46) = -((s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(51) = (s(4)*(s(9) - u(2) + u(8))**2*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(52) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = -((s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(8)*(s(9) - u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(64) = (s(8)*(s(10) + s(11) + u(3))**2)/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(8)*(s(10) + s(11) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(8)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) - u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(6)*(s(10) + s(11) + u(3))**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &  Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 + &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(69) = -((s(4)*(s(9) - u(2) + u(8))*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9)))/&
        &    ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5) + &
        & (s(4)*(s(9) - u(2) + u(8))*(u(3) - u(9)))/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

        kThat(70) = -((s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)))/&
        &    Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2))*(u(3) - u(9))**2)/&
        &  ((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)**1.5 - &
        & (s(4)*(u(3) - u(9))**2)/((s(9) - u(2) + u(8))**2 + (u(3) - u(9))**2)

    else if (BC_flag == 220) then ! bottom fixed, right end free
        kThat(1) = (s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(2) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(7) = -((s(1)*(s(9) - u(-6) + u(0))**2*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))**2)/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))**2*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 - &
        & (s(3)*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(8) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(u(-5) - u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(Sqrt(s(11)**2 + s(12)**2) - Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(9) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(10) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(19) = (s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(20) = -((s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &    Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)) - &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 + &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)

        kThat(25) = -((s(1)*(s(9) - u(-6) + u(0))*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(-u(-5) + u(1)))/&
        &    ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5) + &
        & (s(1)*(s(9) - u(-6) + u(0))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) - &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1)))/((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(3)*(s(12) - u(0))*(s(11) + u(1))*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(26) = (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)))/&
        &  Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(1)*(-s(9) + Sqrt((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2))*(u(-5) - u(1))*(-u(-5) + u(1)))/&
        &  ((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2)**1.5 - &
        & (s(1)*(u(-5) - u(1))*(-u(-5) + u(1)))/((s(9) - u(-6) + u(0))**2 + (u(-5) - u(1))**2) + &
        & (s(3)*(s(11) + u(1))**2)/((s(12) - u(0))**2 + (s(11) + u(1))**2) - &
        & (s(3)*(s(11) + u(1))**2*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  ((s(12) - u(0))**2 + (s(11) + u(1))**2)**1.5 + &
        & (s(3)*(-Sqrt(s(11)**2 + s(12)**2) + Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2)))/&
        &  Sqrt((s(12) - u(0))**2 + (s(11) + u(1))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(27) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(28) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(Sqrt(s(10)**2 + s(12)**2) - &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(Sqrt(s(10)**2 + s(12)**2) - Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(39) = (s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(40) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(43) = -((s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(44) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(45) = -((s(4)*(s(9) - u(-4) + u(2))**2*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))**2)/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + (s(6)*u(2)**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))**2)/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*u(2)**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(7)*(s(9) + u(2))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(12) - u(0) + u(2))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(46) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(u(-3) - u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(57) = (s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(58) = -((s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &    Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)) - &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 + &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)

        kThat(61) = -((s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(62) = -((s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)) + &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 - &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

        kThat(63) = -((s(4)*(s(9) - u(-4) + u(2))*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(-u(-3) + u(3)))/&
        &    ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5) + &
        & (s(4)*(s(9) - u(-4) + u(2))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(6)*u(2)*(s(10) + s(11) + u(3)))/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3)))/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*u(2)*(s(10) + s(11) + u(3))*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(7)*(s(9) + u(2))*(s(10) + s(11) + u(3))*&
        &    (-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  ((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 - &
        & (s(2)*(s(12) - u(0) + u(2))*(s(10) - u(1) + u(3))*&
        &    (-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5

        kThat(64) = (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)))/&
        &  Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(4)*(-s(9) + Sqrt((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2))*(u(-3) - u(3))*(-u(-3) + u(3)))/&
        &  ((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2)**1.5 - &
        & (s(4)*(u(-3) - u(3))*(-u(-3) + u(3)))/((s(9) - u(-4) + u(2))**2 + (u(-3) - u(3))**2) + &
        & (s(6)*(s(10) + s(11) + u(3))**2)/(u(2)**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(7)*(s(10) + s(11) + u(3))**2)/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) + &
        & (s(2)*(s(10) - u(1) + u(3))**2)/((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2) - &
        & (s(6)*(s(10) + s(11) + u(3))**2*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/&
        &  (u(2)**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(6)*(-s(10) - s(11) + Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2)))/Sqrt(u(2)**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(7)*(s(10) + s(11) + u(3))**2*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + &
        &      Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)**1.5 + &
        & (s(7)*(-Sqrt(s(9)**2 + (s(10) + s(11))**2) + Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2)))/&
        &  Sqrt((s(9) + u(2))**2 + (s(10) + s(11) + u(3))**2) - &
        & (s(2)*(s(10) - u(1) + u(3))**2*(-Sqrt(s(10)**2 + s(12)**2) + &
        &      Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  ((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)**1.5 + &
        & (s(2)*(-Sqrt(s(10)**2 + s(12)**2) + Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)))/&
        &  Sqrt((s(12) - u(0) + u(2))**2 + (s(10) - u(1) + u(3))**2)

    end if

    do it = 1, DoF
        kThat(3*DoF*(it-1)+DoF+it) = kThat(3*DoF*(it-1)+DoF+it) + a(it)
    end do

    end subroutine calc_kThat_metabeam


    !=============================================================================
    !=============================================================================
    subroutine calc_fs_pendula(BC_flag, lowerBound, upperBound, u, s, fs)

    !! Data dictionary
    integer, intent(in) :: BC_flag
    integer, intent(in) :: lowerBound
    integer, intent(in) :: upperBound
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s
    real, intent(out), dimension(DoF) :: fs

    if (BC_flag == 100) then
        fs(1) = (s(3)*s(4)*s(2)*Sin(u(0)) - s(1)*u(-1) + 2*s(1)*u(0) - s(1)*u(1)) 
    else if (BC_flag == 110) then
        fs(1) = (s(3)*s(4)*s(2)*Sin(u(0)) + s(1)*(u(0) - u(1)))
    else if (BC_flag == 120) then
        fs(1) = (s(3)*s(4)*s(2)*Sin(u(0)) - s(1)*u(-1) + s(1)*u(0))
    else if (BC_flag == 121) then
        fs(1) = 0.
    end if

    end subroutine calc_fs_pendula



    !=============================================================================
    !=============================================================================
    subroutine calc_kThat_pendula(BC_flag, lowerBound, UpperBound, u, s, a, kThat)

    !! Data dictionary
    integer, intent(in) :: BC_flag
    integer, intent(in) :: lowerBound
    integer, intent(in) :: upperBound
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s
    real, intent(in), dimension(DoF) :: a
    real, intent(out), dimension(3*DoF*DoF) :: kThat
    integer :: it

    if (BC_flag == 100) then
        kThat(1) = -s(1)
        kThat(2) = s(3)*s(4)*s(2)*COS(u(0)) + 2*s(1)
        kThat(3) = -s(1)
    else if (BC_flag == 110) then
        kThat(1) = 0.
        kThat(2) = s(3)*s(4)*s(2)*COS(u(0)) + s(1)
        kThat(3) = -s(1)
    else if (BC_flag == 120) then
        kThat(1) = -s(1)
        kThat(2) = s(3)*s(4)*s(2)*COS(u(0)) + s(1)
        kThat(3) = 0.
    else if (BC_flag == 121) then
        kThat(1) = 0.
        kThat(2) = 0.
        kThat(3) = 0.
    end if

    do it = 1, DoF
        kThat(3*DoF*(it-1)+DoF+it) = kThat(3*DoF*(it-1)+DoF+it) + a(it)
    end do

    end subroutine calc_kThat_pendula


    !=============================================================================
    !=============================================================================
    subroutine calc_fs_phi4(BC_flag, lowerBound, upperBound, u, s, fs)

    ! Data dictionary:
    integer, intent(in) :: BC_flag ! Boundary condition
    integer, intent(in) :: lowerBound !
    integer, intent(in) :: upperBound !
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s !
    real, intent(out), dimension(DoF) :: fs !

    ! Calculation for fs
    if (BC_flag == 100) then ! baseline, periodic
        fs(1) = s(2) - s(1)*u(-1) + (2*s(1) + 2*s(3))*u(0) + 3*s(4)*u(0)**2 + 4*s(5)*u(0)**3 - s(1)*u(1)
    else if (BC_flag == 110) then ! baseline, left end free
        fs(1) = s(2) + s(1)*u(0) + 2*s(3)*u(0) + 3*s(4)*u(0)**2 + 4*s(5)*u(0)**3 - s(1)*u(1) 
    else if (BC_flag == 120) then ! baseline, right end free
        fs(1) = s(2) - s(1)*u(-1) + (s(1) + 2*s(3))*u(0) + 3*s(4)*u(0)**2 + 4*s(5)*u(0)**3
    end if

    end subroutine calc_fs_phi4


    !=============================================================================
    !=============================================================================
    subroutine calc_kThat_phi4(BC_flag, lowerBound, upperBound, u, s, a, kThat)

    ! Data dictionary:
    integer, intent(in) :: BC_flag ! Boundary condition
    integer, intent(in) :: lowerBound !
    integer, intent(in) :: upperBound !
    real, intent(in), dimension(lowerBound:upperBound) :: u !
    real, intent(in), dimension(s_dim) :: s !
    real, intent(in), dimension(DoF) :: a
    real, intent(out), dimension(3*DoF*DoF) :: kThat !
    integer :: it

    if (BC_flag == 100) then ! baseline, periodic
        kThat(1) = -s(1)
        kThat(2) = 2*s(1) + 2*s(3) + 6*s(4)*u(0) + 12*s(5)*u(0)**2
        kThat(3) = -s(1)
    else if (BC_flag == 110) then ! baseline, left end free
        kThat(1) = 0.
        kThat(2) = s(1) + 2*s(3) + 6*s(4)*u(0) + 12*s(5)*u(0)**2
        kThat(3) = -s(1)
    else if (BC_flag == 120) then ! baseline, right end free
        kThat(1) = -s(1)
        kThat(2) = s(1) + 2*s(3) + 6*s(4)*u(0) + 12*s(5)*u(0)**2
        kThat(3) = 0.
    end if

    do it = 1, DoF
        kThat(3*DoF*(it-1)+DoF+it) = kThat(3*DoF*(it-1)+DoF+it) + a(it)
    end do

    end subroutine calc_kThat_phi4



    !=============================================================================
    !=============================================================================
    subroutine calc_du(N_inv, tol_inv, N_loc, procID, noProc, kThat, res, du, t_sim, cnt_inv, t_inv_total)

    use mpi

    ! Data dictionary:
    integer, intent(in) :: N_inv ! max number of itertations for matrix inversion
    real, intent(in) :: tol_inv !
    integer, intent(in) :: n_loc ! No. of unit cells per process
    integer, intent(in) :: procID, noProc
    real, intent(in), dimension(3*DoF*DoF*N_loc) :: kThat !
    real, intent(in), dimension(DoF*N_loc) :: res !
    real, intent(out), dimension(DoF*(N_loc+2)) :: du !
    real, intent(in) :: t_sim
    integer, intent(inout) :: cnt_inv
    real, intent(inout) :: t_inv_total
    ! Data dictionary:
    integer :: ierr, status(MPI_STATUS_SIZE)
    real, dimension(DoF*(N_loc+2)) :: d
    real, dimension(DoF*N_loc) :: g
    real, dimension(DoF*N_loc) :: t
    real, dimension(2) :: dn1_loc, dn2_loc 
    real, dimension(2) :: dn1, dn2 ! dn1(1)->d1, dn1(2)->n1
    real :: s
    integer :: it, it2, it3, it4, ind, ind2
    real :: t_inv_start, t_inv_end

    call MPI_BARRIER(MPI_COMM_WORLD, ierr)
    t_inv_start = MPI_WTIME()

    d = 0.
    du = 0.
    g = -res
    do it = 1, N_inv
        if (procID == 0 .and. it == N_inv) then
            write (*,*) " >> WARNING: Max number of iterations for matrix inversion reached &
                &at simulation time t=", t_sim, "."
            write (*,*) "n1 is ", dn1(2)
            cnt_inv = cnt_inv + it
        end if
        dn1_loc(1) = DOT_PRODUCT(g, g)
        do it2 = 1, N_loc
            ind = 3*DoF*DoF*(it2-1)
            do it3 = 1, DoF
                g(DoF*(it2-1)+it3) = DOT_PRODUCT(kThat(ind+3*DoF*(it3-1)+1:ind+3*DoF*it3), &
                    &du(DoF*(it2-1)+1:DoF*(it2+2))) - res(DoF*(it2-1)+it3)
            end do
        end do
!        call MPI_ALLREDUCE(MAXVAL(ABS(g)), g_max, 1, MPI_DOUBLE_PRECISION, MPI_MAX, MPI_COMM_WORLD, ierr)
!        if (g_max < tol_inv) then
!            cnt_inv = cnt_inv+it
!            call MPI_BARRIER(MPI_COMM_WORLD, ierr)
!            t_inv_end = MPI_WTIME()
!            t_inv_total = t_inv_total + t_inv_end - t_inv_start
!            exit
!        end if

        dn1_loc(2) = DOT_PRODUCT(g, g)
        call MPI_Allreduce(dn1_loc(1), dn1(1), 2, MPI_DOUBLE_PRECISION, MPI_SUM, MPI_COMM_WORLD, ierr)
        if (dn1(2) < tol_inv) then
            cnt_inv = cnt_inv+it
            call MPI_BARRIER(MPI_COMM_WORLD, ierr)
            t_inv_end = MPI_WTIME()
            t_inv_total = t_inv_total + t_inv_end-t_inv_start
            exit
        end if
        d(DoF+1:DoF*(N_loc+1)) = -g + dn1(2)/dn1(1)*d(DoF+1:DoF*(N_loc+1))
        dn2_loc(2) = DOT_PRODUCT(d(DoF+1:DoF*(N_loc+1)), g)
        if (noProc /=1) then
            if (procID == 0) then
                call MPI_SEND(d(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & MPI_COMM_WORLD, ierr)
                call MPI_RECV(d(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, &
                & MPI_COMM_WORLD, status, ierr)
            else if (procID == noProc-1) then
                call MPI_SEND(d(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & MPI_COMM_WORLD, ierr) 
                call MPI_RECV(d(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, &
                & MPI_COMM_WORLD, status, ierr)
            else
                call MPI_SENDRECV(d(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & d(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, MPI_COMM_WORLD, status, ierr)
                call MPI_SENDRECV(d(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & d(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, MPI_COMM_WORLD, status, ierr)
            end if
        end if
        do it2 = 1, N_loc
            ind = 3*DoF*DoF*(it2-1)
            do it3 = 1, DoF
                t(DoF*(it2-1)+it3) = DOT_PRODUCT(kThat(ind+3*DoF*(it3-1)+1:ind+3*DoF*it3), &
                    &d(DoF*(it2-1)+1:DoF*(it2+2)))
            end do
        end do
        dn2_loc(1) = DOT_PRODUCT(d(DoF+1:DoF*(N_loc+1)), t)
        call MPI_Allreduce(dn2_loc(1), dn2(1), 2, MPI_DOUBLE_PRECISION, MPI_SUM, MPI_COMM_WORLD, ierr)
        s = -dn2(2)/dn2(1)
        du(DoF+1:DoF*(N_loc+1)) = du(DoF+1:DoF*(N_loc+1)) + s*d(DoF+1:DoF*(N_loc+1))

        if (noProc /=1) then
            if (procID == 0) then
                call MPI_SEND(du(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & MPI_COMM_WORLD, ierr)
                call MPI_RECV(du(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, &
                & MPI_COMM_WORLD, status, ierr)
            else if (procID == noProc-1) then
                call MPI_SEND(du(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & MPI_COMM_WORLD, ierr) 
                call MPI_RECV(du(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, &
                & MPI_COMM_WORLD, status, ierr)
            else
                call MPI_SENDRECV(du(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & du(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, MPI_COMM_WORLD, status, ierr)
                call MPI_SENDRECV(du(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & du(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, MPI_COMM_WORLD, status, ierr)
            end if
        end if


    end do


    end subroutine calc_du


    !=============================================================================
    !=============================================================================
    subroutine NR_iterations(N_NR, tol_NR, N_loc, procID, noProc, prob_flag, BC, s, &
    & a1_loc, phat_loc, u_loc, N_inv, tol_inv, t_sim, cnt_NR, cnt_inv, t_NR_total, t_inv_total)

    use mpi

    ! Data dictionary:
    integer, intent(in) :: N_NR ! max number of itertations for matrix inversion
    real, intent(in) :: tol_NR !
    integer, intent(in) :: N_loc ! No. of unit cells per process
    integer, intent(in) :: procID, noProc
    integer, intent(in) :: prob_flag
    integer, intent(in), dimension(0:2) :: BC
    real, intent(in), dimension(s_dim) :: s
    real, intent(in), dimension(DoF*N_loc) :: a1_loc
    real, intent(in), dimension(DoF*N_loc) :: phat_loc
    real, intent(inout), dimension(DoF*(N_loc+2)) :: u_loc
    integer, intent(in) :: N_inv
    real, intent(in) :: tol_inv
    real, intent(in) :: t_sim
    integer, intent(out) :: cnt_NR
    integer, intent(out) :: cnt_inv
    real, intent(inout) :: t_NR_total
    real, intent(inout) :: t_inv_total
    ! Data dictionary:
    integer :: ierr, status(MPI_STATUS_SIZE)
    real, dimension(DoF) :: fs
    real, dimension(DoF*N_loc) :: res
    real :: resSum_loc
    real :: resSum
    real, dimension(3*DoF*DoF*N_loc) :: kThat_loc
    real, dimension(DoF*(N_loc+2)) :: du_loc
    integer :: it, it2, it3, ind
    real :: t_NR_start, t_NR_end

    call MPI_BARRIER(MPI_COMM_WORLD, ierr)
    t_NR_start = MPI_WTIME()
    cnt_inv = 0
    do it = 1, N_NR
        !resSum_loc= 0.
        do it2 = 1, N_loc
            if (it2 == 1 .and. procID == 0) then
                call p_calc_fs(BC(1), 0, 2*DoF-1, u_loc(DoF*it2+1), s, fs)
            else if (it2 == N_loc .and. procID == noProc-1) then
                call p_calc_fs(BC(2), -DoF, DoF-1, u_loc(DoF*(it2-1)+1), s, fs)
            else
                call p_calc_fs(BC(0), -DoF, 2*DoF-1, u_loc(DoF*(it2-1)+1), s, fs)
            end if

            ind = DoF*(it2-1)
            res(ind+1:ind+DoF) = phat_loc(ind+1:ind+DoF) - fs - a1_loc(ind+1:ind+DoF)*&
                &u_loc(ind+DoF+1:ind+2*DoF)
        end do

        resSum_loc = DOT_PRODUCT(res, res)
        call MPI_Allreduce(resSum_loc, resSum, 1, MPI_DOUBLE_PRECISION, MPI_SUM, MPI_COMM_WORLD, ierr)
        if (resSum < tol_NR) then
            cnt_NR = it
            call MPI_BARRIER(MPI_COMM_WORLD, ierr)
            t_NR_end = MPI_WTIME()
            t_NR_total = t_NR_total + t_NR_end - t_NR_start
            exit
        end if

        if (procID == 0 .and. it == N_NR) then
            write (*,*) "WARNING: Max number of NR iterations reached at siumaltion time &
                &t=", t_sim, "."
            write (*,*) "resSum is ", resSum
            cnt_NR = it
        end if
        
        do it2 = 1, N_loc
            if (it2 == 1 .and. procID == 0) then
                call p_calc_kThat(BC(1), 0, 2*DoF-1, u_loc(DoF*it2+1), s, a1_loc(DoF*(it2-1)+1), &
                & kThat_loc(3*DoF*DoF*(it2-1)+1))
            else if (it2 == N_loc .and. procID == noProc-1) then
                call p_calc_kThat(BC(2), -DoF, DoF-1, u_loc(DoF*(it2-1)+1), s, a1_loc(DoF*(it2-1)+1), &
                & kThat_loc(3*DoF*DoF*(it2-1)+1))
            else
                call p_calc_kThat(BC(0), -DoF, 2*DoF-1, u_loc(DoF*(it2-1)+1), s, a1_loc(DoF*(it2-1)+1), &
                & kThat_loc(3*DoF*DoF*(it2-1)+1))
            end if
        end do

        call calc_du(N_inv, tol_inv, N_loc, procID, noProc, kThat_loc, res, du_loc, t_sim, cnt_inv, t_inv_total)
        u_loc = u_loc + du_loc
        
        if (noProc /=1) then
            if (procID == 0) then
                call MPI_SEND(u_loc(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & MPI_COMM_WORLD, ierr)
                call MPI_RECV(u_loc(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, &
                & MPI_COMM_WORLD, status, ierr)
            else if (procID == noProc-1) then
                call MPI_SEND(u_loc(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & MPI_COMM_WORLD, ierr) 
                call MPI_RECV(u_loc(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, &
                & MPI_COMM_WORLD, status, ierr)
            else
                call MPI_SENDRECV(u_loc(DoF+1), DoF, MPI_DOUBLE_PRECISION, procID-1, 0, &
                & u_loc(1), DoF, MPI_DOUBLE_PRECISION, procID-1, 1, MPI_COMM_WORLD, status, ierr)
                call MPI_SENDRECV(u_loc(DoF*N_loc+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 1, &
                & u_loc(DoF*(N_loc+1)+1), DoF, MPI_DOUBLE_PRECISION, procID+1, 0, MPI_COMM_WORLD, status, ierr)
            end if
        end if

!        do it2 = 1, DoF*N_loc
!            resSum_loc = resSum_loc + abs(du_loc(it2)*res(it2))
!        end do
!        call MPI_Allreduce(resSum_loc, resSum, 1, MPI_DOUBLE_PRECISION, MPI_SUM, MPI_COMM_WORLD, ierr)
!        if (resSum < tol_NR) then
!            cnt_NR = it
!            call MPI_BARRIER(MPI_COMM_WORLD, ierr)
!            t_NR_end = MPI_WTIME()
!            t_NR_total = t_NR_total + t_NR_end - t_NR_start
!            exit
!        end if

    end do

    end subroutine NR_iterations


    subroutine calc_load(LC_loc, LC_val_loc, t, p_loc, u_loc)

    !! Data dictionary
    real, parameter :: PI=3.141592653589793
    integer, intent(in), dimension(3) :: LC_loc
    real, intent(in), dimension(7) :: LC_val_loc
    real, intent(in) :: t
    real, intent(out) :: p_loc
    real, intent(out) :: u_loc

    if ( LC_loc(3) == 1 ) then
        if ( t >= LC_val_loc(1) .and. t <= LC_val_loc(2) ) then
            p_loc = LC_val_loc(3)*SIN(2*PI*LC_val_loc(4)*t + LC_val_loc(5))
        end if
    else if ( LC_loc(3) == 2 ) then
        if ( t >= LC_val_loc(1) .and. t <= LC_val_loc(2) ) then
            p_loc = LC_val_loc(3)*SIN(2*PI*LC_val_loc(4)*t + LC_val_loc(5))*&
                & SIN(PI*(t-LC_val_loc(6))/(LC_val_loc(7)-LC_val_loc(6)))**2
        end if
    else if ( LC_loc(3) == 11 ) then !!! To be implemented
        if ( t >= LC_val_loc(1) .and. t <= LC_val_loc(2) ) then
            u_loc = LC_val_loc(3)*SIN(2*PI*LC_val_loc(4)*t + LC_val_loc(5))
        end if
    else if (LC_loc(3) == 12) then !!! To be implemented
        if ( t >= LC_val_loc(1) .and. t <= LC_val_loc(2) ) then
            u_loc = LC_val_loc(3)*SIN(2*PI*LC_val_loc(4)*t + LC_val_loc(5))*&
                & SIN(PI*(t-LC_val_loc(1))/(LC_val_loc(2)-LC_val_loc(1)))**2
        end if
!    else if (LC_loc(3) == 13) then !!! To be implemented
!        if ( t >= LC_val_loc(1) .and. t <= LC_val_loc(2) ) then
!            u_loc = L(4) - LC_val_loc(3)*COS(2*PI*LC_val_loc(4)*t + LC_val_loc(5))
!        end if
    end if

    end subroutine calc_load

end module sub_nb
